# ТУТ ОСОБЕННОСТИ Dockerfile
# всегда лучше указывать максимально расширенную версию (для совместимости на разных машинах, т.к. докер кеширует образы)
FROM python3.7

# Каждая команда RUN это новый слой. Поэтому лучше делать все в одной команде RUN.
# В текущей версии Docker нет тормозов из-за множества слоев
RUN apt-get install cpp
RUN cpp ...
RUN apt-get remove cpp

# Не надо так делать. В разных окружениях (машинах) могут обновиться разные пакеты системы и приложение может не работать одинаково
RUN apt-get update

# На каждом этапе docker может кешировать результат, если результат не менялся. Получается, если зависимости не поменялись, то установка зависимостей будет закеширована
COPY requirements.txt .
RUN pip install -r requirements.txt
# А вот это копирование всех файлов проекта нужно в конце, чтобы все вышестоящие шаги не запускались (а брались из кеша)
COPY . .



# Логи не надо писать в файлик. Лучше писать в stdout, stderr.
# Приложение должно обрабатывать сигналы ОС, например, sigterm (gracefull shutdown).
# Говорят, что best practice 1 процесс на 1 контейнер, например, 1 воркер в php-fpm.